
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Anton Sundqvist" name="author"/>
<link href="http://astemes.com/30_CI%20Integration/CI%20Integration/" rel="canonical"/>
<link href="../../Style/logo.png" rel="icon"/>
<meta content="mkdocs-1.2.3, mkdocs-material-7.3.4" name="generator"/>
<title>CI Integration - Astemes LUnit</title>
<link href="../../assets/stylesheets/main.db9e7362.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.3f5d1f46.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../Style/style.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ci-integration">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Astemes LUnit" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Astemes LUnit">
<img alt="logo" src="../../Style/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Astemes LUnit
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              CI Integration
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/astemes/astemes-lunit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Astemes LUnit" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Astemes LUnit">
<img alt="logo" src="../../Style/logo.png"/>
</a>
    Astemes LUnit
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/astemes/astemes-lunit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../10_Basics/">
        Basics
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../20_Framework%20Architecture/">
        Framework Architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../24_Profiling%20Tools/">
        Profiling Tools
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          CI Integration
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        CI Integration
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#executing-tests-from-the-command-line">
    Executing Tests from the Command Line
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#capturing-the-test-results">
    Capturing the Test Results
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#jenkins-example">
    Jenkins Example
  </a>
<nav aria-label="Jenkins Example" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#footnote-on-test-finder-indexing">
    * Footnote on Test Finder indexing
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../40_Real-Time%20Systems/">
        Real-Time Systems
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../81_Creating%20Report%20Plugins/Creating%20Report%20Plugins/">
        Creating Report Plugins
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
          License
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="License" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          License
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../90_License/10_Astemes%20LUnit/LICENSE/">
        Astemes LUnit
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../90_License/80_JKI%20Flat%20UI%20Controls/JKI%20Flat%20UI%20Controls%202.0%20License/">
        JKI Flat UI Controls
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#executing-tests-from-the-command-line">
    Executing Tests from the Command Line
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#capturing-the-test-results">
    Capturing the Test Results
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#jenkins-example">
    Jenkins Example
  </a>
<nav aria-label="Jenkins Example" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#footnote-on-test-finder-indexing">
    * Footnote on Test Finder indexing
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/astemes/astemes-lunit/edit/master/docs/30_CI Integration/CI Integration.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="ci-integration">CI Integration</h1>
<p>LUnit was designed to easily and natively integrate into continuous integration (CI) pipelines.
To achieve this, a way of executing tests from the command line is needed and the results need to be available in a format which may be digested by the CI system.</p>
<h2 id="executing-tests-from-the-command-line">Executing Tests from the Command Line</h2>
<p>The command line interface (CLI) has been migrated out of the main LUnit project.
The reason for this is that the CLI is installed on the system level and requires to be installed as administrator.
To install the native CLI, please use <a href="https://www.vipm.io/package/astemes_lib_lunit_cli/">this package</a>. 
There is also a G-CLI package, maintained by Sam at SAS Workshops, which can be found <a href="https://www.vipm.io/package/sas_workshops_lib_lunit_for_g_cli/">here</a> (please note that this document does not apply the G-CLI).</p>
<p>LUnit installs a command line operation using the LabVIEW native <a href="https://zone.ni.com/reference/en-XX/help/371361R-01/lvhowto/cli_running_operations/">LabVIEWCLI by NI</a>.
This operation is named LUnit and may be called using LabVIEWCLI -OperationName LUnit.
An example illustrating the usage of the CLI i provided at <code>...\LabVIEW 20XX\examples\Astemes\LUnit\LUnit CLI Demo.vi</code>.
A path to load tests from is provided using the -ProjectPath argument and the report directory is specified using the -ReportPath argument.</p>
<p>When executing tests from the command line, the test case index is cleared and re-created by default each time.
This ensures that all inherited test methods are detected*, at the expense of some overhead for test discovery.
The <code>-ClearIndex</code> flag may be used to override this behavior and re-use the index to improve the execution time.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><nobr><code>-ProjectPath</code></nobr></td>
<td>The project containing the tests to be executed. The interface also accepts libraries or test case classes of types .lvlib or .lvclass.</td>
</tr>
<tr>
<td><nobr><code>-TestRunners</code></nobr></td>
<td>Specifies the number of parallel test runners to spawn. Default value is 1.</td>
</tr>
<tr>
<td><nobr><code>-ReportPath</code></nobr></td>
<td>The output path for the report file generated. The execution generates either a .txt-file or an .xml-file, based on the path specified.</td>
</tr>
<tr>
<td><nobr><code>-ClearIndex</code></nobr></td>
<td>Clear the index and force LUnit to rediscover all tests. Default is <code>True</code>. The index must be cleared to find new tests inherited for a Test Case.</td>
</tr>
</tbody>
</table>
<p>The LabVIEW CLI uses VI Server and by default it is configured to work on port 3363.
You will need to make sure that the connection is not blocked by firewalls.</p>
<h2 id="capturing-the-test-results">Capturing the Test Results</h2>
<p>Test results are saved in a text based format at the location specified when executing the command line operation.</p>
<p>LUnit has a built in xml-format for test reports which is using the same structure as the one used by JUnit testing framework and specified <a href="https://llg.cubic.org/docs/junit/">here</a>.
To use the JUnit xml format, you must provide a file path with the <code>.xml</code> extension.
Once the tests have finished, the result file is available at the specified path.
File may now be digested by most CI tools.
For Jenkins this is done using the <a href="https://plugins.jenkins.io/junit/">JUnit plugin</a>.</p>
<h2 id="jenkins-example">Jenkins Example</h2>
<p>Jenkins is a popular open source automation server used for continuous integration and delivery pipelines.
A pipeline in Jenkins may be configured using a declarative Jenkinsfile which may be saved directly in the repository.
Below is an example showing a basic configuration.</p>
<pre><code class="language-java">pipeline {
    agent any
    environment{
        LV_PROJECT_PATH = "Path to Your LabVIEW Project.lvproj"
        NUM_TEST_RUNNERS = "1"
        LV_PORT = "3363"
    }
    stages {
        stage('Unit Tests') {
            steps {
                bat "LabVIEWCLI -OperationName LUnit -ProjectPath \"${WORKSPACE}\\${LV_PROJECT_PATH}\" -TestRunners ${NUM_TEST_RUNNERS} -ReportPath \"${WORKSPACE}\\lunit_reports\\lunit.xml\" -ClearIndex TRUE -PortNumber ${LV_PORT} -LogFilePath \"${WORKSPACE}\\LabVIEWCLI_LUnit.txt\" -LogToConsole true -Verbosity Default"

                junit "lunit_reports\\*.xml"
            }
        }
    }
}
</code></pre>
<p>The pipeline above declares three environment variables used to configure the call to LUnit using the LabVIEW CLI.
The first is the path to the project file relative to the workspace, <em>i.e.</em> the path relative to the root of the repository where the Jenkinsfile is located.
The second is the number of parallel test runners to spawn, here configured to one. 
The third parameter is the port configured for VI server in LabVIEW under Tools-&gt;Options-&gt;VI Server.</p>
<p>The report is saved in the path <code>lunit_reports</code> using the file name <code>lunit.xml</code> with incrementing index.
After the execution of tests using the bat command the junit plugin is called to digest the report files generated.
This requires that the Jenkins JUnit plugin is installed, which it is by using the recommended default settings when installing Jenkins.</p>
<p>Note that this is a minimal example meant to demonstrate the concept. 
It could be improved significantly to reduce the details in the Jenkinsfile using shared libraries.
As an example, the build system used to build LUnit uses a simpler command <code>runLUnit "${LV_PROJECT_PATH}"</code> in the Jenkinsfile in stead of the rather detailed <code>bat</code> command.</p>
<h3 id="footnote-on-test-finder-indexing">* Footnote on Test Finder indexing</h3>
<p>The test finder keeps an index of all test methods for all test classes in the project.
When the test finder is started, it loads the index and compares all classes to the index.
If the classes has changed since the index was created, the class will be re-indexed.
As of version 1.0, the test indexer will however not re-index a class when a parent class has added a dynamic test method.
To detect new inherited dynamic method the test index must be re-created, which happens when the <code>-ClearIndex</code> flag is left at default value <code>True</code>.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Profiling Tools" class="md-footer__link md-footer__link--prev" href="../../24_Profiling%20Tools/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Profiling Tools
            </div>
</div>
</a>
<a aria-label="Next: Real-Time Systems" class="md-footer__link md-footer__link--next" href="../../40_Real-Time%20Systems/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Real-Time Systems
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright Â© 2021 - 2025 Astemes
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
            Material for MkDocs
          </a>
 ... <a class="link--pdf-download" download href="..\..\Astemes LUnit.pdf" title="PDF">download PDF</a></div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
<script src="../../assets/javascripts/bundle.1e84347e.min.js"></script>
</body>
</html>